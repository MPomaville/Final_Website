---
title: Third Graph - Are all continents approaching the global mean life expectancy?
author: Matt Pomaville
date: '2018-06-13'
slug: third-graph-are-all-continents-approaching-the-global-mean-life-expectancy
categories:
  - CS631
  - R
tags:
  - ggplot
description: Desc
hacker_news_id: ''
lobsters_id: ''
meta_img: /images/image.jpg
---



<div id="life-expectancy-by-continent-vs.global-mean-life-expectancy-graph-brief" class="section level1">
<h1>Life expectancy by continent vs. global mean life expectancy graph brief</h1>
<p>This is a brief describing the graph created from the gapminder dataset. It is available as a CRAN Package by installing <code>gapminder</code> and calling <code>library(gapminder)</code> during setup.</p>
<div id="load-required-libraries" class="section level2">
<h2>Load required libraries</h2>
<p>To make this graph I used the <code>tidyverse</code>, <code>gapminder</code>, and <code>wesanderson</code> libraries.</p>
<pre class="r"><code>library(tidyverse)
library(gapminder)
library(wesanderson)</code></pre>
<p>In this visalization I want to examine the relative number of countries in each continent with life expectancies over themean life expectancy in 2007 by year.</p>
</div>
</div>
<div id="analyzing-the-graph" class="section level1">
<h1>Analyzing the Graph</h1>
<div id="type-of-graph" class="section level2">
<h2>Type of Graph</h2>
<p>The graph presented is a grouped bar graph.</p>
</div>
<div id="data-used" class="section level2">
<h2>Data used</h2>
<p>The data for this graph came from the <code>gapminder</code> R package generated by Jennifer Bryan and available from CRAN.</p>
</div>
<div id="cleaning-up-the-gapminder-data" class="section level2">
<h2>Cleaning up the gapminder data</h2>
<div id="getting-the-global-mean-life-expectancy-in-2007" class="section level3">
<h3>Getting the global mean life expectancy in 2007</h3>
<p>I first need to filter for only the 2007 data and get the mean across all nations.</p>
<pre class="r"><code>gapminder_2007 &lt;- gapminder %&gt;% 
  filter(year == 2007)

gapminder_2007 %&gt;% 
  summarize(mean(lifeExp))</code></pre>
<p>The mean life expectancy for all nations was `r gapminder_2007 %&gt;% summarize(mean(lifeExp))</p>
</div>
<div id="getting-the-continental-mean-life-expectancy-and-number-of-countries-in-each-continent" class="section level3">
<h3>Getting the continental mean life expectancy and number of countries in each continent</h3>
<p>Next, I needed to get the mean life expectancy and number of countries in each continent for each year.</p>
<pre class="r"><code>#The only way I can think to get the number of countries over the world 2007 mean is to add a column to `gapminder` with a 1 if the value is over the mean and a 0 if its less, then summing that column when I pull the mean and the total countries...
gapminder_cont_mean &lt;- gapminder %&gt;% 
  mutate(over_mean = if_else(lifeExp &gt;= 67, 1, 0))  %&gt;% 
  group_by(year, continent) %&gt;% 
  summarize(mean(lifeExp), n(), sum(over_mean)) %&gt;% 
  ungroup()

colnames(gapminder_cont_mean) &lt;- c(&quot;year&quot;, &quot;continent&quot;, &quot;mean_lifeExp&quot;, &quot;total_countries&quot;, &quot;over_mean&quot;)</code></pre>
</div>
<div id="getting-the-proportion-of-countries-over-the-global-mean" class="section level3">
<h3>Getting the proportion of countries over the global mean</h3>
<p>This code adds a column with the proportion of countries in a continent over the 2007 global mean in a given year.</p>
<pre class="r"><code>gapminder_cont_mean &lt;- gapminder_cont_mean %&gt;% 
  mutate(prop_over = over_mean/total_countries) %&gt;% 
  mutate(year = as.factor(year))</code></pre>
</div>
<div id="information-about-gapminder_cont_mean" class="section level3">
<h3>Information about <code>gapminder_cont_mean</code></h3>
<p>The data frame <code>gapminder_cont_mean</code> has 6 columns:</p>
<ul>
<li>year - The year the data was collected in</li>
<li>continent - The content the data was collected on/for</li>
<li>mean_lifeExp - The mean of the life expectanceis across countries on a continent for a given year</li>
<li>total_countries - The number of countries on a continent in a given year</li>
<li>over_mean - The total number of countries with mean life expectancy over the 2007 global mean in a given year</li>
<li>prop_over - The proportion of countries with mean life expectancy over the 2007 mean in a given year. Gotten by dividing <code>over_mean</code> by <code>total_countries</code>.</li>
</ul>
</div>
</div>
<div id="audience" class="section level2">
<h2>Audience</h2>
<p>The graph is designed for general consumption, particularly by individuals interested in population trends across time. THere are no elements of this graph that would be uninterperable to someone with a general understanding of population growth.</p>
</div>
<div id="description" class="section level2">
<h2>Description</h2>
<p>This graph shows the proportion of countries on each continent with a mean life expectancy over the global mean life expectancy in 2007 on the x-axis, grouped by year on the y-axis. The general trend is that all continents are approaching the 2007 global mean, but that some continents are approaching all countries being at or over the global mean faster than others. For example, Oceania has been over the global mean from the first data collected in 1952, while Africa only has a small number of countries near at the global mean in 2007.</p>
<div id="how-to-read-it" class="section level3">
<h3>How to read it</h3>
<p>When approaching this graph, it is helpful to look at the trends both within x-axis groups and across the whole data set. For example, it may be useful to see how the difference in proportion between Europs and Asia has changed across the entire graph.</p>
</div>
<div id="annotation-and-presentation" class="section level3">
<h3>Annotation and Presentation</h3>
<p>Annotations coule be used to mark years with specific events that could effect the mean life expectancy for a continent, such as a famine, war, or disease. Color is used in this version to denote countries.</p>
</div>
<div id="variations" class="section level3">
<h3>Variations</h3>
<p>This same data coule be shown with a series of boxplots using and a line at the global 2007 mean. In fact, that plot may be more informative because it would show how more information about the values of each country rather than a simple binary value of “yes they are at or above the mean” or “no they are not at or above the mean”.</p>
</div>
</div>
<div id="methods" class="section level2">
<h2>Methods</h2>
</div>
<div id="making-the-graph" class="section level2">
<h2>Making the graph</h2>
<p>The graph is made from the <code>gapminder_cont_mean</code> data frame generated above.</p>
<pre class="r"><code>life_exp &lt;- ggplot(gapminder_cont_mean, aes(x = year, y = prop_over, fill = continent))+
                     geom_bar(position = &quot;dodge&quot;, stat = &quot;identity&quot;)+
  ggtitle(&quot;How close is each continent to the global mean life expectancy?&quot;)+
  labs(subtitle = &quot;Proportion of countries per continent with life expectancies \ngreater than or equal to the 2007 world mean&quot;, x = &quot;Year&quot;, y = &quot;Proportion of countries over the 2007 mean&quot;, fill = &quot;Continent&quot;)+
  scale_fill_manual(values = wes_palette(&quot;Darjeeling1&quot;))+
  theme_bw()</code></pre>
<p>To make the graph I generated a general ggplot object calles <code>life_exp</code> from the <code>gapminder_cont_mean</code> data frame. It uses <code>year</code> as the x-axis value and <code>prop_over</code> as the y-axis value. It also adds fill color to the bars based on <code>continent</code>. I then applied a <code>geom_bar</code> layer to the object, specifying that the bars would be arranged adjacently and would have no further statistical processing applied. Finally, I added a title, subtitle, axis and legend titles, and changed the default colors to use colors from the <code>wesanderson</code> package <code>Darjeeling</code> palette.</p>
<pre class="r"><code>life_exp</code></pre>
<p><img src="/blog/2018-06-13-third-graph-are-all-continents-approaching-the-global-mean-life-expectancy_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
</div>
</div>
